# Purpose: This program writes a complete list of directories, subdirectories, and files to a text file named IndexOfDirectory.txt.
# It also displays the file size and the time/date it was last modified
# Authors: Willie Santos, Polina Khapikova
# version: 1.0
# date: 18 July 2017

# Import os module
import os
# Import math and time module
import math, time



# Set listing start location
start_path = "C:\Polina"
dir_count = 0
file_count = 0

#make a new file
outputFile = open("IndexOfDirectory", "w")

# Traverse directory tree
for (path, dirs, files) in os.walk(start_path):
    outputFile.write('Directory: {:s}'.format(path))
    dir_count += 1
    # Repeat for each file in directory
    for file in files:
        fstat = os.stat(os.path.join(path, file))

        # Convert file size to MB, KB or Bytes
        if (fstat.st_size > 1024 * 1024):
            fsize = math.ceil(fstat.st_size / (1024 * 1024))
            unit = "MB"
        elif (fstat.st_size > 1024):
            fsize = math.ceil(fstat.st_size / 1024)
            unit = "KB"
        else:
            fsize = fstat.st_size
            unit = "B"

        # The time the file was modified
        mtime = time.strftime("%X %x", time.gmtime(fstat.st_mtime))

        # Write file name, size, date modified to the output file
        outputFile.write('\t{:15.15s}{:8d} {:2s} {:18s}'.format(file, fsize, unit, mtime))
        file_count += 1

        outputFile.write('\n')

# Write total files and directory count to file
outputFile.write('\nFound {} files in {} directories.'.format(file_count, dir_count))

# Close output file
outputFile.close()